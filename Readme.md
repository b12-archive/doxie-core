[![Coveralls – test coverage
](https://img.shields.io/coveralls/studio-b12/doxie-core.svg?style=flat-square)
](https://coveralls.io/r/studio-b12/doxie-core)
 [![Travis – build status
](https://img.shields.io/travis/studio-b12/doxie-core/master.svg?style=flat-square)
](https://travis-ci.org/studio-b12/doxie-core)
 [![David – status of dependencies
](https://img.shields.io/david/studio-b12/doxie-core.svg?style=flat-square)
](https://david-dm.org/studio-b12/doxie-core)
 [![Stability: unstable
](https://img.shields.io/badge/stability-unstable-yellowgreen.svg?style=flat-square)
](https://github.com/studio-b12/doxie-core/issues/3)
 [![Code style: airbnb
](https://img.shields.io/badge/code%20style-airbnb-blue.svg?style=flat-square)
](https://github.com/airbnb/javascript)




doxie-core
==========

**The heart of <http://npm.im/doxie>.**




<p align="center"><a
  title="Graphic by the great Justin Mezzell"
  href="http://justinmezzell.tumblr.com/post/89652317743"
  >
  <br/>
  <br/>
  <img
    src="Readme/Compass.gif"
    width="400"
    height="300"
  />
  <br/>
  <br/>
</a></p>


 

The CLI program *[doxie][]* claims to be “the simplest docs generator you’ve seen”. *doxie-core* is the heart of *[doxie][]*, so it’s inherently [very simple][].

All it does is take an array of data and pipe it through a bunch of plugins (functions). Just keep in mind that most plugins will expect *[dox][]*-compatible data. That’s it.

See for yourself:

[doxie]:        https://github.com/studio-b12/doxie
[dox]:          https://github.com/tj/dox
[very simple]:  ./module/index.js




Demo
----

Let’s see what happens without any plugins to pipe through:

```js
import doxie from 'doxie-core'

const doxComments = [
  {isPrivate: false},
  {isPrivate: true},
  {isPrivate: false},
];

doxie([])(doxComments);

//» {chunks: [
//»   {data: {isPrivate: false}},
//»   {data: {isPrivate: true}},
//»   {data: {isPrivate: false}},
//» ], version: '1'}
```


Simple, but not very useful. Let’s try filtering that data:

```js
const myFilter = ({data}) => !data.isPrivate;

doxie([
  require('doxie.filter')(myFilter),
])(doxComments).chunks;

//» [
//»   {data: {isPrivate: false}},
//»   {data: {isPrivate: false}},
//» ]
```


Fair enough. But the whole business is about outputting docs for humans. Let’s try that then:

```js
let counter = 1;
const myTemplate = ({data}) => ({data,
  output: `${data.isPrivate ? 'Private' : 'Public'} comment ${counter++}\n`
});

doxie([
  require('doxie.filter')(myFilter),
  require('doxie.template')(myTemplate),
  require('doxie.output')(),
])(doxComments).output;

//» "Public comment 1
//» Public comment 2
//» "
```




Installation
------------

```sh
$ npm install doxie-core
```




API
---

<h3><pre>
doxie-core(plugins, [{stdout, stderr}])
  → pipeline
</pre></h3>

**Parameters:**

* `plugins` {Function[]}  
  An array of plugin functions. You can pick one of the [ready-made plugins][] or [write your own][].

* `[options.stdout]` {Writable Stream}  
  If set, the `output` of each plugin will be written to this stream.

* `[options.stderr]` {Writable Stream}  
  If set, the `error` of each plugin will be written to this stream.

[ready-made plugins]:  https://www.npmjs.com/browse/keyword/doxie-plugin
[write your own]:      #writing-a-plugin




<a                                                    id="writing-a-plugin"></a>
Writing a plugin
----------------

Every plugin for *doxie* is a function. Here’s the signature it should match:

<h3><pre>
plugin({chunks, version})
  → {chunks, version, [output], [error]}
</pre></h3>


**Input object properties:**

The input object is passed directly by *doxie-core* if the `plugin` is the first in the functional pipeline. Otherwise it’s the output of the former plugin.

* `chunks`  {Object[]}  
  An array of `chunk`s. Every `chunk` is a part of the documentation. It can either:
  * correspond to *[dox][]* output for a single comment; or
  * be generated by a plugin – such as a description for a group of comments.

* `[chunks[].data]`  {Object}  
  `chunk.data` is populated if the chunk corresponds to an item of the input array – a *[dox][]* comment fed into *doxie*. This object is immutable and should be copied directly to the corresponding output `chunk.data`.

* `[chunks[].output]`  {String}  
  `chunk.output` is populated if other plugins have generated output for this chunk.

* `version`  {String}  
  The exact string `"1"`.


**Output object properties:**

The output object is processed by *doxie* to produce side-effects – and passed unchanged as input to the subsequent plugin.

* `chunks`  {Object[]}  
  The array of `chunks`. See the input `chunks` property for more info.

* `[chunks[].data]`  {Object}  
  Make sure you copy the `data` from the corresponding input `chunk`. *doxie* doesn’t need it, but you may break subsequent plugins if you don’t.

* `[chunks[].output]`  {String}  
  The rendered text output of this chunk.

* `version`  {String}  
  The exact string `"1"`.

* `[error]`  {Error}  
  If `stderr` is defined, `error` will be written to `stderr`.

* `[output]` {String}  
  If `stdout` is defined, `output` will be written to `stdout`.




License
-------

[MIT][] © [Studio B12 GmbH][]

[MIT]: ./License.md
[Studio B12 GmbH]: http://studio-b12.de
